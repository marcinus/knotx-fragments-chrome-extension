<!--
  Copyright (C) 2019 Knot.x Project

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Knot.x Functional Test: Payments</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="http://cognifide.com/favicon.ico?v=2"/>
  <link href="https://bootswatch.com/4/simplex/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="jumbotron">
        <h2>
          Hello Knot.x - a reactive integration framework!
        </h2>
        <p>
          This page combines dynamic data with a template. A template may consist of many
          independent
          fragments defining the data they require. Dynamic data may come from external web APIs,
          databases etc.
        </p>
        <p>
          <a class="btn btn-primary btn-large"
             href="https://github.com/Knotx/knotx">Learn more</a>
        </p>
      </div>
    </div>
  </div>
  <div class="row" style="margin-left: 10px">
    <!-- data-knotx-id="d704bd38-ab94-4a2f-9358-a43fd5efc202" --><script data-knotx-debug="log" data-knotx-id="d704bd38-ab94-4a2f-9358-a43fd5efc202" type="application/json">{"finishTime":1585047693887,"fragment":{"id":"d704bd38-ab94-4a2f-9358-a43fd5efc202","type":"snippet","configuration":{"data-knotx-task":"user-task"},"body":"\n      <div>\n        <h2>User details</h2>\n        <p>Id: 3214232</p>\n        <p>Name: Redford</p>\n        <p>Surname: Cornborough</p>\n        <p>Email: rcornborough0@theatlantic.com</p>\n      </div>\n    ","payload":{"fetch-user-info":{"_request":{"type":"HTTP","source":"/service/mock/userInfo.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":{"id":3214232,"first_name":"Redford","last_name":"Cornborough","email":"rcornborough0@theatlantic.com","gender":"Male","credit_card_type":"visa","credit_card_number":"3562444175055197","user_group":"premium"}}}},"graph":{"finished":1585047693687,"id":"789a8202-0694-431d-942e-a568b57f22c5","label":"fetch-user-info","on":{"_success":{"finished":1585047693887,"id":"7ff9f30a-6bf0-43b5-b35a-8ef0920a2525","label":"te-hbs","on":{},"operation":{"data":{"alias":"te-hbs","actionFactory":"knot","actionConfig":{"address":"knotx.knot.te.handlebars","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[],"transition":"_success"},"started":1585047693705,"status":"SUCCESS","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{},"requestBody":""},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:65517/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}],"transition":"_success"},"started":1585047693638,"status":"SUCCESS","subtasks":[],"type":"SINGLE"},"startTime":1585047693687,"status":"SUCCESS"}</script>
      <div>
        <h2>User details</h2>
        <p>Id: 3214232</p>
        <p>Name: Redford</p>
        <p>Surname: Cornborough</p>
        <p>Email: rcornborough0@theatlantic.com</p>
      </div>
    <!-- data-knotx-id="d704bd38-ab94-4a2f-9358-a43fd5efc202" -->
  </div>
  <div class="row">
    <div class="row" style="margin-left: 10px">
      <!-- data-knotx-id="acb40701-946d-4605-b5e9-056e8a16becb" --><script data-knotx-debug="log" data-knotx-id="acb40701-946d-4605-b5e9-056e8a16becb" type="application/json">{"finishTime":1585047693997,"fragment":{"id":"acb40701-946d-4605-b5e9-056e8a16becb","type":"snippet","configuration":{"data-knotx-task":"payments-task"},"body":"\n        <div>\n          <h2>Payment providers</h2>\n          <ul>\n                        <li>\n              <p>Payment provider: PayPal premium</p>\n              <p>Payment URL: https://paypal-example.com/payment?id=1983247919hv9sa398f</p>\n            </li>\n                        <li>\n              <p>Payment provider: PayU</p>\n              <p>Payment URL: https://payu-example.com/tr?id=afj08aw398gha0we9ge</p>\n            </li>\n                        <li>\n              <p>Payment provider: Credit Card</p>\n              <p>Payment URL: https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4</p>\n            </li>\n                      </ul>\n        </div>\n      ","payload":{"fetch-user-info":{"_request":{"type":"HTTP","source":"/service/mock/userInfo.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":{"id":3214232,"first_name":"Redford","last_name":"Cornborough","email":"rcornborough0@theatlantic.com","gender":"Male","credit_card_type":"visa","credit_card_number":"3562444175055197","user_group":"premium"}},"fetch-payment-providers":{"_request":{"type":"HTTP","source":"/service/mock/paymentProviders.json","metadata":{"headers":{}}},"_response":{"success":true,"metadata":{"statusCode":"200","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]}}},"_result":[{"verified":true,"paymentUrl":"https://paypal-example.com/payment?id=1983247919hv9sa398f","name":"PayPal premium"},{"verified":true,"paymentUrl":"https://payu-example.com/tr?id=afj08aw398gha0we9ge","name":"PayU"},{"verified":true,"paymentUrl":"https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4","name":"Credit Card"}]},"fetch-offers":{"_result":{"fallback":"json-syntax-error"}},"fetch-delivery":{"_result":{"fallback":"action ended with _timeout"}}}},"graph":{"finished":1585047693681,"id":"efb347f9-949f-4035-9277-a12f82f9a107","label":"fetch-user-info","on":{"_success":{"finished":1585047693997,"id":"b48d32f6-3b8b-4929-a47b-2ce2243ac69b","label":"composite","on":{"_success":{"finished":1585047693997,"id":"de9c59fd-98c8-47f5-8e07-b2f2fd2a686f","label":"te-pebble","on":{},"operation":{"data":{"alias":"te-pebble","actionFactory":"knot","actionConfig":{"address":"knotx.knot.te.pebble","deliveryOptions":{"sendTimeout":3000},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[],"transition":"_success"},"started":1585047693807,"status":"SUCCESS","subtasks":[],"type":"SINGLE"}},"operation":{"data":{},"factory":"subtasks"},"response":{"invocations":[],"transition":"_success"},"started":1585047693684,"status":"SUCCESS","subtasks":[{"finished":1585047693705,"id":"8027193d-f56f-4327-a9e7-0156d06a8f7c","label":"fetch-payment-providers","on":{"_error":{"finished":0,"id":"5d0bc656-0fc7-4104-a878-733e4ba75418","label":"fetch-payment-providers-fallback","on":{},"operation":{"data":{"alias":"fetch-payment-providers-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{},"started":0,"status":"UNPROCESSED","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-payment-providers","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/paymentProviders.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-payment-providers","logs":{"request":{"path":"/service/mock/paymentProviders.json","requestHeaders":{},"requestBody":""},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:65517/service/mock/paymentProviders.json"},"responseBody":"[\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://paypal-example.com/payment?id=1983247919hv9sa398f\",\n    \"name\": \"PayPal premium\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://payu-example.com/tr?id=afj08aw398gha0we9ge\",\n    \"name\": \"PayU\"\n  },\n  {\n    \"verified\": true,\n    \"paymentUrl\": \"https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4\",\n    \"name\": \"Credit Card\"\n  }\n]"},"doActionLogs":[]}],"transition":"_success"},"started":1585047693684,"status":"SUCCESS","subtasks":[],"type":"SINGLE"},{"finished":1585047693715,"id":"6011c79c-e3e6-4063-a4b9-50cbfbe4fd27","label":"fetch-offers","on":{"_error":{"finished":1585047693722,"id":"07310515-cec9-4939-bcc4-a6452b0c4755","label":"fetch-offers-fallback","on":{},"operation":{"data":{"alias":"fetch-offers-fallback","actionFactory":"inline-payload","actionConfig":{"alias":"fetch-offers","payload":{"_result":{"fallback":"json-syntax-error"}},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-offers-fallback","logs":{"key":"fetch-offers","value":{"_result":{"fallback":"json-syntax-error"}}},"doActionLogs":[]}],"transition":"_success"},"started":1585047693716,"status":"SUCCESS","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-offers","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/specialOffers.xml","port":65517},"responseOptions":{"forceJson":true,"predicates":[]},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-offers","logs":{"request":{"path":"/service/mock/specialOffers.xml","requestHeaders":{},"requestBody":""},"response":{"httpVersion":"HTTP_1_1","statusCode":"500","statusMessage":"Server Error","headers":{"Content-Type":["text/html; charset=ISO-8859-1"],"Cache-Control":["must-revalidate,no-cache,no-store"],"Content-Length":["2643"],"Connection":["close"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:65517/service/mock/specialOffers.xml"},"errors":[{"className":"java.io.IOException","message":"The service responded with unsuccessful status code: 500"}]},"doActionLogs":[]}],"transition":"_error"},"started":1585047693687,"status":"ERROR","subtasks":[],"type":"SINGLE"},{"finished":1585047693801,"id":"b29f8539-0387-4aa3-90c1-5249438f26ce","label":"fetch-delivery-options-cb","on":{"_fallback":{"finished":1585047693802,"id":"2b3bd4b6-c21c-455c-b80a-1126725d677b","label":"fetch-delivery-timeout","on":{},"operation":{"data":{"alias":"fetch-delivery-timeout","actionFactory":"inline-payload","actionConfig":{"alias":"fetch-delivery","payload":{"_result":{"fallback":"action ended with _timeout"}},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-delivery-timeout","logs":{"key":"fetch-delivery","value":{"_result":{"fallback":"action ended with _timeout"}}},"doActionLogs":[]}],"transition":"_success"},"started":1585047693802,"status":"SUCCESS","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-delivery-options-cb","actionFactory":"cb","actionConfig":{"circuitBreakerName":"delivery-cb","circuitBreakerOptions":{"maxRetries":1,"timeout":50},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-delivery-options-cb","logs":{"invocationCount":"2","error":"Exception: class io.vertx.circuitbreaker.TimeoutException. operation timeout"},"doActionLogs":[]}],"transition":"_fallback"},"started":1585047693688,"status":"OTHER","subtasks":[],"type":"SINGLE"}],"type":"COMPOSITE"},"_custom":{"finished":0,"id":"7b85fe19-7194-4fc3-b818-a6032cc44427","label":"fetch-user-info-custom-fallback","on":{},"operation":{"data":{"alias":"fetch-user-info-custom-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{},"started":0,"status":"UNPROCESSED","subtasks":[],"type":"SINGLE"},"_error":{"finished":0,"id":"ee41e740-fc7c-43c7-84df-06ade4969efe","label":"fetch-user-info-fallback","on":{"_success":{"finished":0,"id":"93d3b9dc-2296-4915-b9b9-3de420bc363b","label":"fetch-user-info-fallback-success","on":{},"operation":{"data":{"alias":"fetch-user-info-fallback-success","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{},"started":0,"status":"UNPROCESSED","subtasks":[],"type":"SINGLE"},"_error":{"finished":0,"id":"75a32950-97ab-43bf-8b8e-f5426171fada","label":"fetch-user-info-fallback-error","on":{},"operation":{"data":{"alias":"fetch-user-info-fallback-error","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{},"started":0,"status":"UNPROCESSED","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-user-info-fallback","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/placeholderFallback.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{},"started":0,"status":"UNPROCESSED","subtasks":[],"type":"SINGLE"}},"operation":{"data":{"alias":"fetch-user-info","actionFactory":"http","actionConfig":{"endpointOptions":{"allowedRequestHeaders":["Content-Type"],"domain":"localhost","path":"/service/mock/userInfo.json","port":65517},"logLevel":"info"}},"factory":"action"},"response":{"invocations":[{"alias":"fetch-user-info","logs":{"request":{"path":"/service/mock/userInfo.json","requestHeaders":{},"requestBody":""},"response":{"httpVersion":"HTTP_1_1","statusCode":"200","statusMessage":"OK","headers":{"Content-Type":["application/json; charset=UTF-8"],"Transfer-Encoding":["chunked"],"Server":["Jetty(9.2.24.v20180105)"]},"trailers":{},"httpMethod":"GET","requestPath":"localhost:65517/service/mock/userInfo.json"},"responseBody":"{\n  \"id\": 3214232,\n  \"first_name\": \"Redford\",\n  \"last_name\": \"Cornborough\",\n  \"email\": \"rcornborough0@theatlantic.com\",\n  \"gender\": \"Male\",\n  \"credit_card_type\": \"visa\",\n  \"credit_card_number\": \"3562444175055197\",\n  \"user_group\": \"premium\"\n}"},"doActionLogs":[]}],"transition":"_success"},"started":1585047693662,"status":"SUCCESS","subtasks":[],"type":"SINGLE"},"startTime":1585047693682,"status":"SUCCESS"}</script>
        <div>
          <h2>Payment providers</h2>
          <ul>
                        <li>
              <p>Payment provider: PayPal premium</p>
              <p>Payment URL: https://paypal-example.com/payment?id=1983247919hv9sa398f</p>
            </li>
                        <li>
              <p>Payment provider: PayU</p>
              <p>Payment URL: https://payu-example.com/tr?id=afj08aw398gha0we9ge</p>
            </li>
                        <li>
              <p>Payment provider: Credit Card</p>
              <p>Payment URL: https://cc-example.com/pay/19g8esry9se8rgyse90r8ug4</p>
            </li>
                      </ul>
        </div>
      <!-- data-knotx-id="acb40701-946d-4605-b5e9-056e8a16becb" -->
    </div>
  </div>
</div>
</body>
</html>